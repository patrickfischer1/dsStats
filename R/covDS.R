#' 
#' @title Computes covariance between two or more vectors
#' @description this function is similar to R function 'cov'
#' @param x a character, the name of a vector, dataframe or matrix
#' @param y (optional) a character, the name of a vector, dataframe or matrix
#' @param use a character string giving a method for computing covariances in the 
#' presence of missing values. This must be one of the strings: "everything", "all.obs", 
#' "complete.obs", "na.or.complete", or "pairwise.complete.obs".
#' @return covariance
#' @author Gaye, A.
#' @export
#' 
covDS <-function (x=NULL, y=NULL, use=NULL){
  todo <- use
  # check what vectors are factors and turn them into numeric
  if(class(x)=='matrix' | class(x)=='data.frame'){
    rc <- c()
    for(i in 1:dim(x)[2]){
      rc <- append(rc, class(x[,i]))
    }
    idx <- which(rc == 'factor')
    if(length(idx) > 0){
      x[, idx] <- sapply(x[, idx], as.character)
      x[, idx] <- sapply(x[, idx], as.numeric)
    }
    output1 <- cov(x,use=todo)
    completeCount <- output1
    cls <- colnames(x)
    
    cmpCases <- matrix(ncol = dim(x)[1], nrow = dim(completeCount)[2])
    
    for(i in 1:dim(completeCount)[2]) {
      
      cmpCases[i, ] = complete.cases(x[, i])
    }
    
    for(i in 1:dim(completeCount)[2]){
      for(j in i:dim(completeCount)[2]){
        if(i == j){
          count <- sum(cmpCases[i, ])
        }else{
          count <- sum(cmpCases[i, ] & cmpCases[j, ])
        }
        completeCount[i,j] <- round(count,0)
        completeCount[j,i] <- round(count,0)
      }
    }
    output2 <- completeCount
    output <- list(output1, output2)
  }else{
    if(class(x)=='factor'){
      x <- as.character(x)
      x <- as.numeric(x)
    }
    if(class(y)=='factor'){
      y <- as.character(y)
      y <- as.numeric(y)
    }
    output1 <- cov(x,y,use=todo)
    output2 <- count <- length(which((complete.cases(cbind(x, y))==TRUE)))
    output <- list(output1, output2)
  }
  
  return(output)
}